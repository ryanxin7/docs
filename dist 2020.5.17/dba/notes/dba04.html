<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第三章 SQL基础应用 | Ryan’s Notebook</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <meta name="description" content="潇洒坦荡，干净纯良">
    <link rel="preload" href="/assets/css/0.styles.0466186e.css" as="style"><link rel="preload" href="/assets/js/app.834cea00.js" as="script"><link rel="preload" href="/assets/js/2.19f70e3a.js" as="script"><link rel="preload" href="/assets/js/18.f4a703e0.js" as="script"><link rel="prefetch" href="/assets/js/10.686e04b4.js"><link rel="prefetch" href="/assets/js/11.2c8f62c2.js"><link rel="prefetch" href="/assets/js/12.226ad65d.js"><link rel="prefetch" href="/assets/js/13.fbb6e9c1.js"><link rel="prefetch" href="/assets/js/14.441ad51d.js"><link rel="prefetch" href="/assets/js/15.92ff9b7d.js"><link rel="prefetch" href="/assets/js/16.72a7437b.js"><link rel="prefetch" href="/assets/js/17.a1b29136.js"><link rel="prefetch" href="/assets/js/19.90a77879.js"><link rel="prefetch" href="/assets/js/20.6ead822e.js"><link rel="prefetch" href="/assets/js/21.051e978e.js"><link rel="prefetch" href="/assets/js/22.034f33fc.js"><link rel="prefetch" href="/assets/js/23.7ce776b2.js"><link rel="prefetch" href="/assets/js/24.7c3f6403.js"><link rel="prefetch" href="/assets/js/25.cc4dfdb2.js"><link rel="prefetch" href="/assets/js/26.bf0acc91.js"><link rel="prefetch" href="/assets/js/3.ec15601e.js"><link rel="prefetch" href="/assets/js/4.4dd28791.js"><link rel="prefetch" href="/assets/js/5.6b80a2e8.js"><link rel="prefetch" href="/assets/js/6.0d9d5ffe.js"><link rel="prefetch" href="/assets/js/7.f3f00815.js"><link rel="prefetch" href="/assets/js/8.61d17a0e.js"><link rel="prefetch" href="/assets/js/9.ccf5949f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0466186e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ryan’s Notebook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux 课程笔记
</a></div><div class="nav-item"><a href="/dba/" class="nav-link router-link-active">
  DBA 课程笔记
</a></div><div class="nav-item"><a href="/cloud/" class="nav-link">
  私有云技术
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker&amp;K8S" class="dropdown-title"><span class="title">Docker&amp;K8S</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/baodian/zero/" class="nav-link">
  初级开发篇
</a></li><li class="dropdown-item"><!----> <a href="/baodian/high/" class="nav-link">
  中高进阶篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  Linux 课程笔记
</a></div><div class="nav-item"><a href="/dba/" class="nav-link router-link-active">
  DBA 课程笔记
</a></div><div class="nav-item"><a href="/cloud/" class="nav-link">
  私有云技术
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker&amp;K8S" class="dropdown-title"><span class="title">Docker&amp;K8S</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/baodian/zero/" class="nav-link">
  初级开发篇
</a></li><li class="dropdown-item"><!----> <a href="/baodian/high/" class="nav-link">
  中高进阶篇
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具箱" class="dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          在线编辑
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          在线服务
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          博客指南
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DBA-DAY01</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DBA-DAY02</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DBA-DAY03</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>DBA-DAY04</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dba/notes/dba04.html" class="active sidebar-link">第三章 SQL基础应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-上节回顾" class="sidebar-link">1.上节回顾</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-1-group-by-name-分组-排序-对比-去重" class="sidebar-link">1.1 group by name  分组   排序 对比 去重</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-2-关于group-by-的sql-mode" class="sidebar-link">1.2 关于group by 的sql_mode</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-3-group-concat-多列-转为一行" class="sidebar-link">1.3 group_concat 多列 转为一行</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-4-concat-拼接语句-列值拼接" class="sidebar-link">1.4 concat  拼接语句 列值拼接</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-5-关于多表连接语法规则" class="sidebar-link">1.5 关于多表连接语法规则</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-6-创建别名" class="sidebar-link">1.6 创建别名</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-7-distinct-去重复" class="sidebar-link">1.7 distinct 去重复</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_1-8-select-执行顺序" class="sidebar-link">1.8 select 执行顺序</a></li></ul></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_2-扩展类内容-元数据获取" class="sidebar-link">2. 扩展类内容 元数据获取</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_2-1-元数据介绍及获取介绍" class="sidebar-link">2.1 元数据介绍及获取介绍</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_2-2-配合concat-函数拼接语句或命令" class="sidebar-link">2.2. 配合concat( )函数拼接语句或命令</a></li><li class="sidebar-sub-header"><a href="/dba/notes/dba04.html#_2-3-show-常用命令介绍" class="sidebar-link">2.3 show 常用命令介绍</a></li></ul></li></ul></li><li><a href="/dba/notes/dba04-2.html" class="sidebar-link">第四章 索引及执行计划</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第三章-sql基础应用"><a href="#第三章-sql基础应用" class="header-anchor">#</a> 第三章 SQL基础应用</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_1-上节回顾">1.上节回顾</a><ul><li><a href="#_1-1-group-by-name-分组-排序-对比-去重">1.1 group by name  分组   排序 对比 去重</a></li><li><a href="#_1-2-关于group-by-的sql-mode">1.2 关于group by 的sql_mode</a></li><li><a href="#_1-3-group-concat-多列-转为一行">1.3 group_concat 多列 转为一行</a></li><li><a href="#_1-4-concat-拼接语句-列值拼接">1.4 concat  拼接语句 列值拼接</a></li><li><a href="#_1-5-关于多表连接语法规则">1.5 关于多表连接语法规则</a></li><li><a href="#_1-6-创建别名">1.6 创建别名</a></li><li><a href="#_1-7-distinct-去重复">1.7 distinct 去重复</a></li><li><a href="#_1-8-select-执行顺序">1.8 select 执行顺序</a></li></ul></li><li><a href="#_2-扩展类内容-元数据获取">2. 扩展类内容 元数据获取</a><ul><li><a href="#_2-1-元数据介绍及获取介绍">2.1 元数据介绍及获取介绍</a></li><li><a href="#_2-2-配合concat-函数拼接语句或命令">2.2. 配合concat( )函数拼接语句或命令</a></li><li><a href="#_2-3-show-常用命令介绍">2.3 show 常用命令介绍</a></li></ul></li></ul></div><p></p> <h2 id="_1-上节回顾"><a href="#_1-上节回顾" class="header-anchor">#</a> 1.上节回顾</h2> <h3 id="_1-1-group-by-name-分组-排序-对比-去重"><a href="#_1-1-group-by-name-分组-排序-对比-去重" class="header-anchor">#</a> 1.1 group by name  分组   排序 对比 去重</h3> <img src="\img\day04-1.png" alt="day04-1" style="zoom:80%;"> <h3 id="_1-2-关于group-by-的sql-mode"><a href="#_1-2-关于group-by-的sql-mode" class="header-anchor">#</a> 1.2 关于group by 的sql_mode</h3> <div class="custom-block tip"><p class="custom-block-title">说明</p> <p><code>only_full_group_by</code> 参数</p> <ul><li>在5.7版本中MySQL sql_mode参数中自带，5.6和8.0都没有</li> <li>在带有group by 字句的select中，select 后的条件列（非主键列），</li> <li>要么是group by后的列，要么需要在函数中包裹</li></ul></div> <p><strong>关掉限制：</strong> 编辑配置文件时去掉 <code>ONLY_FULL_GROUP_BY</code></p> <img src="\img\day04-2.png" alt="day04-2" style="zoom:80%;"> <h3 id="_1-3-group-concat-多列-转为一行"><a href="#_1-3-group-concat-多列-转为一行" class="header-anchor">#</a> 1.3 group_concat 多列 转为一行</h3> <br> <p><strong>列转行聚合函数</strong></p> <div class="language-plsql line-numbers-mode"><pre class="language-plsql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>host<span class="token punctuation">)</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><img src="\img\day04-3.png" alt="day04-3" style="zoom:80%;"> <br> <h3 id="_1-4-concat-拼接语句-列值拼接"><a href="#_1-4-concat-拼接语句-列值拼接" class="header-anchor">#</a> <strong>1.4 concat</strong> <strong>拼接语句</strong> 列值拼接</h3> <br> <p><strong>做列值拼接</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> concat<span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">,</span><span class="token string">&quot;@&quot;</span><span class="token punctuation">,</span>host<span class="token punctuation">)</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><img src="\img\day04-4.png" alt="day04-4" style="zoom:80%;"> <h3 id="_1-5-关于多表连接语法规则"><a href="#_1-5-关于多表连接语法规则" class="header-anchor">#</a> <strong>1.5</strong> 关于多表连接语法规则</h3> <div class="custom-block tip"><p class="custom-block-title">多表连接语法规则</p> <ul><li><p>1.首先找涉及到的所有表</p></li> <li><p>2.找到表和表之间的关联列</p></li> <li><p>3.关联条件写在 <code>on</code> 后面 <code>A join B on</code> 关联列</p></li> <li><p>4.所有需要查询的信息放在select后</p></li> <li><p>5.其他的过滤条件 <code>where group by having order by limit</code> 往最后放</p></li> <li><p>注意：对多表连接中，驱动表选择数据行少的表。后续所有表的关联列尽量是主键或唯一键（表设计），至少建立一个索引。</p></li></ul></div> <div class="custom-block warning"><p class="custom-block-title">注意 ❗</p> <p>数据行较少的放在左边（驱动表） 因为他要拿整表的数据和右边的表进行关联</p></div> <h3 id="_1-6-创建别名"><a href="#_1-6-创建别名" class="header-anchor">#</a> <strong>1.6</strong> 创建别名</h3> <p><strong>表别名</strong></p> <p><strong>列别名</strong></p> <p>count</p> <p>oldguo  linux  a,b,c,d</p> <p>oldguo  python x，y,z</p> <p>oldboy  linux  10</p> <p>hsw   python 11</p> <h3 id="_1-7-distinct-去重复"><a href="#_1-7-distinct-去重复" class="header-anchor">#</a> <strong>1.7 distinct</strong> <strong>去重复</strong></h3> <br> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> countrycode<span class="token punctuation">)</span> <span class="token keyword">from</span> city<span class="token punctuation">;</span> 
<span class="token comment">//在城市表中 查看所有国家代号 去重复</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><br> <br> <h3 id="_1-8-select-执行顺序"><a href="#_1-8-select-执行顺序" class="header-anchor">#</a> <strong>1.8 select</strong> <strong>执行顺序</strong></h3> <br> <br> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">user</span> <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">from</span> 表  <span class="token keyword">where</span> 列  <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token keyword">user</span> <span class="token keyword">having</span> 列  <span class="token keyword">order</span> <span class="token keyword">by</span> 列 <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">查询语句执行顺序</p> <p>没有索引的情况下会把整表数据加载到内存中，进行过滤过滤后在内存中只留下满足条件的数据。 针对满足条件的数据进行分组 （group by ），在根据select 的条件列取列产生新的结果集，having会对结果集再进行一次过滤。order by 对列数据进行比较大小排列顺序 最后显示。</p></div> <br> <h2 id="_2-扩展类内容-元数据获取"><a href="#_2-扩展类内容-元数据获取" class="header-anchor">#</a> <strong>2.</strong> 扩展类内容 元数据获取</h2> <br> <h3 id="_2-1-元数据介绍及获取介绍"><a href="#_2-1-元数据介绍及获取介绍" class="header-anchor">#</a> <strong>2.1</strong> <strong>元数据介绍及获取介绍</strong></h3> <br> <div class="custom-block tip"><p class="custom-block-title">元数据</p> <p>元数据是存储在&quot;基表&quot;中。</p> <p>通过专用的DDL语句，DCL语句进行修改</p> <p>通过专用视图和命令进行元数据的查询</p> <p><code>information_schema</code>中保存了大量元数据查询的试图</p> <p><code>show</code>  命令是封装好功能，提供元数据查询基础功能</p></div> <br> <p><strong>创建视图：</strong></p> <img src="\img\day04-5.png" alt="day04-5" style="zoom:80%;"> <br> <br> <p><strong>查询视图：</strong></p> <img src="\img\day04-6.png" alt="day04-6" style="zoom:80%;"> <p><strong>2.1 information_schema 的基本应用</strong></p> <p><strong>tables 视图的应用:</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">use</span> information_schema<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">desc</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><img src="\img\day04-7.png" alt="day04-7" style="zoom:80%;"> <img src="\img\day04-8.png" alt="day04-8" style="zoom:80%;"> <br> <br> <br> <br> <p><strong>TABLES 和表有关的元数据</strong></p> <br> <table><thead><tr><th><img width="100/">TABLE_SCHEMA<img width="100/"></th> <th style="text-align:center;"><img width="100/">表所在的库名<img width="100/"></th></tr></thead> <tbody><tr><td>TABLE_NAME</td> <td style="text-align:center;">表名</td></tr> <tr><td>ENGINE</td> <td style="text-align:center;">存储引擎</td></tr> <tr><td>TABLE_ROWS</td> <td style="text-align:center;">数据行</td></tr> <tr><td>AVG_ROW_LENGTH</td> <td style="text-align:center;">平均行长度</td></tr> <tr><td>INDEX_LENGTH</td> <td style="text-align:center;">索引长度</td></tr></tbody></table> <p><strong>举例说明：</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>USE information_schema; 
DESC TABLES;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><strong>显示所有的库和表的信息</strong></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_schema<span class="token punctuation">,</span>table_name <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>显示所有的库和表的信息（结果集多行转成一行）</strong></li></ul> <p>world 库下  <code>city,country,country,language</code></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_schema<span class="token punctuation">,</span>GROUP_CONCAT<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> table_schema<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>查询所有<strong>innodb</strong>引擎的表</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_schema<span class="token punctuation">,</span>table_name <span class="token punctuation">,</span><span class="token keyword">ENGINE</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> 
<span class="token keyword">WHERE</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token string">'innodb'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>统计world下的city表占用空间大小</strong></li></ul> <p>$$
公式：表的数据量=平均行长度*行数+索引长度
$$</p> <p><code>AVG_ROW_LENGTH*TABLE_ROWS+INDEX_LENGTH</code>  统计整个city 表的真实数据量大小</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_name<span class="token punctuation">,</span><span class="token punctuation">(</span>AVG_ROW_LENGTH<span class="token operator">*</span>TABLE_ROWS<span class="token operator">+</span>INDEX_LENGTH<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span> <span class="token comment">//kb显示</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span>
<span class="token keyword">WHERE</span> table_schema<span class="token operator">=</span><span class="token string">'world'</span> <span class="token operator">AND</span> table_name<span class="token operator">=</span><span class="token string">'city'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>统计每个库的数据量大小，并按数据量从大到小排序</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> table_schema<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token punctuation">(</span>AVG_ROW_LENGTH<span class="token operator">*</span>TABLE_ROWS<span class="token operator">+</span>INDEX_LENGTH<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span> <span class="token keyword">AS</span> total_KB    <span class="token punctuation">(</span> 库中有多个表 所以需要加一起 使用 SUM 函数<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> table_schema 库名排队
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">AS</span> total_KB <span class="token keyword">DESC</span> <span class="token punctuation">;</span> 排序
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-2-配合concat-函数拼接语句或命令"><a href="#_2-2-配合concat-函数拼接语句或命令" class="header-anchor">#</a> <strong>2.2.</strong> <strong>配合concat( )函数拼接语句或命令</strong></h3> <p><strong>举例说明：</strong></p> <ul><li>模仿以下语句,进行数据库的分库分表备份。</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>mysqldump <span class="token operator">-</span>uroot <span class="token operator">-</span>p123 world city <span class="token operator">&gt;</span><span class="token operator">/</span>bak<span class="token operator">/</span>world_city<span class="token punctuation">.</span><span class="token keyword">sql</span>  <span class="token comment">//分库分表备份</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>拼接语句：</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
CONCAT<span class="token punctuation">(</span><span class="token string">&quot;mysqldump -uroot -p123 &quot;</span><span class="token punctuation">,</span>table_schema<span class="token punctuation">,</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span>table_name
<span class="token punctuation">,</span><span class="token string">&quot; &gt;/bak/&quot;</span><span class="token punctuation">,</span>table_schema<span class="token punctuation">,</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">,</span>table_name<span class="token punctuation">,</span><span class="token string">&quot;.sql&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><img src="\img\day04-9.png" alt="day04-9" style="zoom:80%;"> <ul><li><strong>模仿以下语句,进行批量生成对world库下所有表进行操作</strong></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> world<span class="token punctuation">.</span>city <span class="token keyword">DISCARD</span> <span class="token keyword">TABLESPACE</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>拼接语句：</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
CONCAT<span class="token punctuation">(</span><span class="token string">&quot;ALTER TABLE &quot;</span><span class="token punctuation">,</span>table_schema<span class="token punctuation">,</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span>table_name<span class="token punctuation">,</span><span class="token string">&quot; DISCARD TABLESPACE;&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span>
<span class="token keyword">WHERE</span> table_schema<span class="token operator">=</span><span class="token string">'world'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-3-show-常用命令介绍"><a href="#_2-3-show-常用命令介绍" class="header-anchor">#</a> <strong>2.3 show 常用命令介绍</strong></h3> <table><thead><tr><th style="text-align:left;"><img width="136/">主要命令<img width="136/"></th> <th><img width="136/">作用说明<img width="136/"></th></tr></thead> <tbody><tr><td style="text-align:left;">show databases;</td> <td>查看数据库名</td></tr> <tr><td style="text-align:left;">show tables;</td> <td>查看表名</td></tr> <tr><td style="text-align:left;">show create database xx;</td> <td>查看建库语句</td></tr> <tr><td style="text-align:left;">show create table xx;</td> <td>查看建表语句</td></tr> <tr><td style="text-align:left;">show processlist;</td> <td>查看所有用户连接情况</td></tr> <tr><td style="text-align:left;">show charset;</td> <td>查看支持的字符集</td></tr> <tr><td style="text-align:left;">show collation;</td> <td>查看所有支持的校对规则</td></tr> <tr><td style="text-align:left;">show grants for xx;</td> <td>查看用户的权限信息</td></tr> <tr><td style="text-align:left;">show variables like '%xx%'</td> <td>查看参数信息</td></tr> <tr><td style="text-align:left;">show engines;</td> <td>查看所有支持的存储引擎类型</td></tr> <tr><td style="text-align:left;">show index from xxx</td> <td>查看表的索引信息</td></tr> <tr><td style="text-align:left;">show engine innodb status\G</td> <td>查看innoDB引擎详细状态信息</td></tr> <tr><td style="text-align:left;">show binary logs</td> <td>查看二进制日志的列表信息</td></tr> <tr><td style="text-align:left;">show binlog events in '二进制文件名'</td> <td>查看二进制日志的事件信息</td></tr> <tr><td style="text-align:left;">show master status ;</td> <td>查看mysql当前使用二进制日志信息</td></tr> <tr><td style="text-align:left;">show slave status\G</td> <td>查看从库状态信息</td></tr> <tr><td style="text-align:left;">show status like ''</td> <td>查看数据库整体状态信息</td></tr> <tr><td style="text-align:left;">help show ;</td> <td>查看更多</td></tr> <tr><td style="text-align:left;">show relaylog events in ''</td> <td>查看中继日志的事件信息</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dba/notes/dba03.html" class="prev">
        第二章 体系结构及管理
      </a></span> <span class="next"><a href="/dba/notes/dba04-2.html">
        第四章 索引及执行计划
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.834cea00.js" defer></script><script src="/assets/js/2.19f70e3a.js" defer></script><script src="/assets/js/18.f4a703e0.js" defer></script>
  </body>
</html>
