(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{443:function(t,e,n){"use strict";n.r(e);var s=n(27),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"集群架构环境统一规划说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#集群架构环境统一规划说明"}},[t._v("#")]),t._v(" 集群架构环境统一规划说明")]),t._v(" "),n("br"),t._v("\n①. 服务器及服务规划说明"),n("br"),t._v(" "),n("br"),t._v("\n②. 主机地址及主机名规划"),n("br"),t._v(" "),n("br"),t._v("\n③. 安装及配置路径等规划"),n("br"),t._v(" "),n("br"),t._v(" "),n("h5",{attrs:{id:"虚拟软件主机虚拟网络配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟软件主机虚拟网络配置"}},[t._v("#")]),t._v(" 虚拟软件主机虚拟网络配置")]),t._v(" "),n("p",[n("strong",[t._v("第一步：在虚拟软件中配置虚拟局域网")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("配置虚拟网段信息，以及虚拟网关信息\n")])])]),n("br"),t._v(" "),n("p",[n("strong",[t._v("第二步：在虚拟软件中虚拟机添加网卡")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("虚拟主机中设置了两块网卡：\n\neth0：nat模式网卡\n\neth1：LAN区段网卡（区段名称为 172.16.1.0/24）\n")])])]),n("br"),t._v(" "),n("p",[n("strong",[t._v("第三步：在虚拟软件中虚拟机网卡配置")]),n("br")]),t._v(" "),n("p",[n("strong",[t._v("第四步：在虚拟软件中虚拟机系统优化")])]),t._v(" "),n("p",[n("strong",[t._v("①. 模板机优化配置---hosts文件配置")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("\\cp /etc/hosts{,.bak}\ncat >/etc/hosts<<EOF\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n172.16.1.5      lb01\n172.16.1.6      lb02\n172.16.1.7      web01\n172.16.1.8      web02\n172.16.1.9      web03\n172.16.1.51     db01\n172.16.1.31     nfs01\n172.16.1.41     backup\n172.16.1.61     m01\nEOF\n")])])]),n("p",[n("strong",[t._v("②. 模板机优化配置---更改yum源")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #更改yum源\n    wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo\n    wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-6.repo\n    #PS：yum repolist 列出yum源信息；讲解什么是epel源\n")])])]),n("p",[n("strong",[t._v("③. 模板机优化配置---关闭selinux")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #关闭selinux\n    sed -i.bak 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n    grep SELINUX=disabled /etc/selinux/config \n    setenforce 0\n    getenforce\n")])])]),n("p",[n("strong",[t._v("④. 模板机优化配置---关闭iptables")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #关闭iptables         \n    /etc/init.d/iptables stop\n    /etc/init.d/iptables stop\n    chkconfig iptables off\n")])])]),n("p",[n("strong",[t._v("⑤. 模板机优化配置---精简开机自启动服务")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v('    #精简开机自启动服务\n    export LANG=en\n    chkconfig|egrep -v "crond|sshd|network|rsyslog|sysstat"|awk \'{print "chkconfig",$1,"off"}\'|bash\n    chkconfig --list|grep 3:on\n')])])]),n("p",[n("strong",[t._v("⑥. 模板机优化配置---提权oldboy可以sudo")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v('    #提权oldboy可以sudo(可选配置)\n    useradd oldboy\n    echo 123456|passwd --stdin oldboy\n    \\cp /etc/sudoers /etc/sudoers.ori\n    echo "oldboy  ALL=(ALL) NOPASSWD: ALL " >>/etc/sudoers\n    tail -1 /etc/sudoers\n    visudo -c\n')])])]),n("p",[n("strong",[t._v("⑦. 模板机优化配置---英文字符集")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #英文字符集\n    cp /etc/sysconfig/i18n /etc/sysconfig/i18n.ori\n    echo 'LANG=\"en_US.UTF-8\"'  >/etc/sysconfig/i18n \n    source /etc/sysconfig/i18n\n    echo $LANG\n")])])]),n("p",[n("strong",[t._v("⑧. 模板机优化配置---时间同步")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #时间同步\n    echo '#time sync by lidao at 2017-03-08' >>/var/spool/cron/root\n    echo '*/5 * * * * /usr/sbin/ntpdate pool.ntp.org >/dev/null 2>&1' >>/var/spool/cron/root\n    crontab -l\n")])])]),n("p",[n("strong",[t._v("⑨. 模板机优化配置---加大文件描述")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #加大文件描述\n    echo '*               -       nofile          65535 ' >>/etc/security/limits.conf \n    tail -1 /etc/security/limits.conf \n")])])]),n("p",[n("strong",[t._v("⑩. 模板机优化配置---内核优化")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #内核优化\ncat >>/etc/sysctl.conf<<EOF\nnet.ipv4.tcp_fin_timeout = 2\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_tw_recycle = 1\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_keepalive_time = 600\nnet.ipv4.ip_local_port_range = 4000    65000\nnet.ipv4.tcp_max_syn_backlog = 16384\nnet.ipv4.tcp_max_tw_buckets = 36000\nnet.ipv4.route.gc_timeout = 100\nnet.ipv4.tcp_syn_retries = 1\nnet.ipv4.tcp_synack_retries = 1\nnet.core.somaxconn = 16384\nnet.core.netdev_max_backlog = 16384\nnet.ipv4.tcp_max_orphans = 16384\n")])])]),n("h1",{attrs:{id:"以下参数是对iptables防火墙的优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#以下参数是对iptables防火墙的优化"}},[t._v("#")]),t._v(" 以下参数是对iptables防火墙的优化")]),t._v(" "),n("p",[n("strong",[t._v("防火墙不开会提示，可以忽略不理")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("net.nf_conntrack_max = 25000000\nnet.netfilter.nf_conntrack_max = 25000000\nnet.netfilter.nf_conntrack_tcp_timeout_established = 180\nnet.netfilter.nf_conntrack_tcp_timeout_time_wait = 120\nnet.netfilter.nf_conntrack_tcp_timeout_close_wait = 60\nnet.netfilter.nf_conntrack_tcp_timeout_fin_wait = 120\nEOF\nsysctl -p\n")])])]),n("p",[n("strong",[t._v("⑾. 模板机优化配置---安装其他小软件")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #安装其他小软件\n    yum install lrzsz nmap tree dos2unix nc telnet sl -y\n")])])]),n("p",[n("strong",[t._v("⑿. 模板机优化配置---ssh连接速度慢优化")])]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    #ssh连接速度慢优化          \n    sed -i.bak 's@#UseDNS yes@UseDNS no@g;s@^GSSAPIAuthentication yes@GSSAPIAuthentication no@g'  /etc/ssh/sshd_config\n    /etc/init.d/sshd reload\n")])])]),n("br"),t._v(" "),n("h1",{attrs:{id:"虚拟主机克隆操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟主机克隆操作"}},[t._v("#")]),t._v(" 虚拟主机克隆操作")]),t._v(" "),n("br"),t._v("\n第一步：调整虚拟主机网络配置信息\n"),n("br"),t._v(" "),n("br"),t._v(" "),n("p",[t._v("分为"),n("strong",[t._v("一清空")]),t._v("和"),n("strong",[t._v("两删除")]),t._v("两个操作")]),t._v(" "),n("p",[n("strong",[t._v("两删除")]),t._v("：删除网卡（eth0 eth1）中，UUID（硬件标识信息）和HWADDR（网络mac地址）进行删除")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    sed -ri '/UUID|HWADDR/d'  /etc/sysconfig/network-scripts/ifcfg-eth[01]\n")])])]),n("p",[n("strong",[t._v("一清空")]),t._v("：清空网络规则配置文件")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    echo '>/etc/udev/rules.d/70-persistent-net.rules' >>/etc/rc.local \n")])])]),n("br"),t._v("\t\t\t\n第二步：关闭虚拟模板机\n"),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("    shutdown -h now\n")])])]),n("br"),t._v("\n第三步：进行模板机的克隆操作\n"),n("p",[n("strong",[t._v("链接克隆")]),t._v("：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("\t优势：节省系统资源  克隆效率较高\n\t劣势：模板主机不能出现问题，一旦模板主机失效，所有克隆主机也无法正常工作\n")])])]),n("p",[n("strong",[t._v("完整克隆")]),t._v("：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v("\t优势：模板主机和克隆主机相互独立，模板主机出现问题，克隆主机依旧可以正常使用\n\t劣势：浪费系统资源  克隆效率较低")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);